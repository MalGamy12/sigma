title: Suspicious Process Execution Masquerading as Legitimate Files
id: c5501435-9b98-4729-a6af-19333c73fed4
status: experimental
description: Detects potentially malicious process executions that employ deceptive naming conventions to masquerade as legitimate file types, such as documents or trusted media files (e.g., .doc, .pdf, .jpg).
references:
   - https://unit42.paloaltonetworks.com/snipbot-romcom-malware-variant/
author: MalGamy
date: 2024-10-01
tags:
   - attack.execution
   - attack.t1036.005  
   - attack.t1204.002
logsource:
   category: process_creation
   product: windows
detection:
   selection:
      Image|endswith:
         - '.pdf.exe'
         - '.doc.exe'
         - '.xlsx.exe'
         - '.jpg.exe'
         - '.png.exe'
         - '.zip.exe'
         - '.rar.exe'
         - '.ppt.exe'
         - '.txt.exe'
         - '.mp4.exe'
         - '.mp3.exe'
         - '.avi.exe'
         - '.mov.exe'
         - '.gif.exe'
         - '.bmp.exe'
         - '.csv.exe'
         - '.log.exe'
         - '.dll.exe'
         - '.rtf.exe'
         - '.bat.exe'
         - '.html.exe'
         - '.php.exe'
         - '.ps1.exe'
         - '.vbs.exe'
         - '.js.exe'
         - '.msi.exe'
         - '.iso.exe'
         - '.tar.exe'
         - '.7z.exe'
         - '.apk.exe'
         - '.bin.exe'
         - '.deb.exe'
         - '.rpm.exe'
         - '.sys.exe'
         - '.svg.exe'
         - '.tiff.exe'
         - '.ini.exe'
         - '.sql.exe'
         - '.json.exe'
         - '.xml.exe'
         - '.dat.exe'
         - '.tmp.exe'
         - '.bak.exe'
         - '.config.exe'
         - '.psd.exe'
         - '.mkv.exe'
         - '.flv.exe'
         - '.ogg.exe'
         - '.wav.exe'
         - '.mid.exe'
         - '.ttf.exe'
         - '.otf.exe'
         - '.epub.exe'
         - '.mobi.exe'
         - '.md.exe'
         - '.md5.exe'
         - '.yml.exe'
         - '.yaml.exe'
         - '.lua.exe'
         - '.sh.exe'
         - '.cmd.exe'
         - '.exe.exe'
         - '.iso.exe'
         - '.dmg.exe'
   condition: selection
falsepositives:
   - unknown
level: critical
